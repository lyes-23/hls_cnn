#ifndef SIGMOID_H
#define SIGMOID_H


#define N 6
#define LUT_SIZE 1024
#define SCALE_FACTOR 85 //(LUT_SIZE - 1) / (2 * N)


static float sigmoidLUT[LUT_SIZE]= {-1.714749, -1.714731, -1.714713, -1.714694, -1.714675, -1.714656, -1.714636, -1.714616, -1.714596, -1.714575, -1.714554, -1.714533, -1.714512, -1.714490, -1.714468, -1.714445, -1.714422, -1.714399, -1.714375, -1.714351, -1.714327, -1.714302, -1.714277, -1.714251, -1.714225, -1.714199, -1.714172, -1.714145, -1.714117, -1.714089, -1.714060, -1.714031, -1.714002, -1.713972, -1.713942, -1.713911, -1.713880, -1.713848, -1.713815, -1.713783, -1.713749, -1.713715, -1.713681, -1.713646, -1.713610, -1.713574, -1.713538, -1.713501, -1.713463, -1.713424, -1.713385, -1.713346, -1.713306, -1.713265, -1.713223, -1.713181, -1.713138, -1.713095, -1.713050, -1.713006, -1.712960, -1.712914, -1.712867, -1.712819, -1.712770, -1.712721, -1.712671, -1.712620, -1.712569, -1.712516, -1.712463, -1.712409, -1.712354, -1.712298, -1.712241, -1.712184, -1.712125, -1.712066, -1.712005, -1.711944, -1.711882, -1.711818, -1.711754, -1.711689, -1.711622, -1.711555, -1.711487, -1.711417, -1.711347, -1.711275, -1.711202, -1.711128, -1.711053, -1.710977, -1.710899, -1.710821, -1.710741, -1.710659, -1.710577, -1.710493, -1.710408, -1.710322, -1.710234, -1.710145, -1.710054, -1.709962, -1.709869, -1.709774, -1.709677, -1.709580, -1.709480, -1.709379, -1.709277, -1.709172, -1.709066, -1.708959, -1.708850, -1.708739, -1.708626, -1.708512, -1.708396, -1.708278, -1.708158, -1.708036, -1.707912, -1.707787, -1.707659, -1.707530, -1.707398, -1.707264, -1.707128, -1.706991, -1.706850, -1.706708, -1.706564, -1.706417, -1.706268, -1.706116, -1.705963, -1.705806, -1.705648, -1.705487, -1.705323, -1.705157, -1.704988, -1.704817, -1.704643, -1.704466, -1.704286, -1.704104, -1.703918, -1.703730, -1.703539, -1.703345, -1.703148, -1.702947, -1.702744, -1.702537, -1.702328, -1.702114, -1.701898, -1.701678, -1.701455, -1.701228, -1.700998, -1.700764, -1.700527, -1.700285, -1.700040, -1.699792, -1.699539, -1.699282, -1.699022, -1.698757, -1.698488, -1.698215, -1.697938, -1.697656, -1.697370, -1.697079, -1.696784, -1.696485, -1.696181, -1.695871, -1.695558, -1.695239, -1.694915, -1.694586, -1.694253, -1.693914, -1.693569, -1.693220, -1.692864, -1.692504, -1.692138, -1.691766, -1.691388, -1.691004, -1.690615, -1.690219, -1.689817, -1.689410, -1.688995, -1.688574, -1.688147, -1.687713, -1.687273, -1.686825, -1.686371, -1.685910, -1.685441, -1.684965, -1.684482, -1.683991, -1.683493, -1.682987, -1.682473, -1.681952, -1.681422, -1.680884, -1.680338, -1.679783, -1.679220, -1.678648, -1.678067, -1.677478, -1.676879, -1.676271, -1.675653, -1.675027, -1.674390, -1.673744, -1.673088, -1.672421, -1.671745, -1.671058, -1.670360, -1.669652, -1.668933, -1.668203, -1.667462, -1.666709, -1.665945, -1.665169, -1.664381, -1.663582, -1.662770, -1.661946, -1.661109, -1.660259, -1.659396, -1.658520, -1.657631, -1.656729, -1.655812, -1.654882, -1.653937, -1.652979, -1.652005, -1.651017, -1.650014, -1.648996, -1.647962, -1.646913, -1.645847, -1.644766, -1.643668, -1.642554, -1.641423, -1.640275, -1.639109, -1.637926, -1.636726, -1.635507, -1.634270, -1.633014, -1.631739, -1.630446, -1.629133, -1.627800, -1.626448, -1.625075, -1.623682, -1.622268, -1.620833, -1.619376, -1.617898, -1.616398, -1.614876, -1.613331, -1.611763, -1.610172, -1.608558, -1.606919, -1.605257, -1.603570, -1.601858, -1.600121, -1.598359, -1.596570, -1.594756, -1.592914, -1.591046, -1.589151, -1.587228, -1.585277, -1.583297, -1.581289, -1.579252, -1.577185, -1.575088, -1.572960, -1.570803, -1.568614, -1.566393, -1.564140, -1.561856, -1.559538, -1.557187, -1.554803, -1.552384, -1.549932, -1.547444, -1.544921, -1.542362, -1.539767, -1.537135, -1.534466, -1.531759, -1.529015, -1.526232, -1.523410, -1.520548, -1.517647, -1.514705, -1.511722, -1.508698, -1.505632, -1.502523, -1.499372, -1.496177, -1.492939, -1.489656, -1.486328, -1.482955, -1.479536, -1.476070, -1.472558, -1.468998, -1.465390, -1.461734, -1.458028, -1.454273, -1.450468, -1.446613, -1.442706, -1.438747, -1.434736, -1.430673, -1.426555, -1.422385, -1.418159, -1.413879, -1.409543, -1.405151, -1.400703, -1.396197, -1.391634, -1.387012, -1.382332, -1.377592, -1.372792, -1.367932, -1.363011, -1.358028, -1.352984, -1.347877, -1.342706, -1.337472, -1.332174, -1.326811, -1.321383, -1.315889, -1.310328, -1.304701, -1.299007, -1.293245, -1.287414, -1.281515, -1.275546, -1.269508, -1.263399, -1.257219, -1.250969, -1.244646, -1.238252, -1.231784, -1.225244, -1.218631, -1.211943, -1.205181, -1.198345, -1.191433, -1.184446, -1.177384, -1.170245, -1.163029, -1.155736, -1.148367, -1.140919, -1.133394, -1.125791, -1.118109, -1.110349, -1.102510, -1.094591, -1.086593, -1.078516, -1.070359, -1.062121, -1.053804, -1.045406, -1.036928, -1.028370, -1.019730, -1.011011, -1.002210, -0.993329, -0.984367, -0.975324, -0.966200, -0.956996, -0.947711, -0.938345, -0.928899, -0.919373, -0.909766, -0.900080, -0.890314, -0.880468, -0.870543, -0.860539, -0.850456, -0.840294, -0.830055, -0.819737, -0.809343, -0.798871, -0.788323, -0.777698, -0.766998, -0.756224, -0.745374, -0.734451, -0.723454, -0.712384, -0.701243, -0.690030, -0.678746, -0.667392, -0.655969, -0.644477, -0.632918, -0.621292, -0.609599, -0.597842, -0.586020, -0.574135, -0.562188, -0.550179, -0.538110, -0.525982, -0.513795, -0.501551, -0.489251, -0.476896, -0.464488, -0.452026, -0.439513, -0.426950, -0.414338, -0.401678, -0.388972, -0.376221, -0.363425, -0.350588, -0.337709, -0.324791, -0.311834, -0.298840, -0.285811, -0.272748, -0.259653, -0.246526, -0.233370, -0.220186, -0.206975, -0.193740, -0.180481, -0.167200, -0.153899, -0.140579, -0.127242, -0.113890, -0.100524, -0.087146, -0.073757, -0.060359, -0.046953, -0.033542, -0.020127, -0.006709, 0.006709, 0.020127, 0.033542, 0.046953, 0.060359, 0.073757, 0.087146, 0.100524, 0.113890, 0.127242, 0.140579, 0.153899, 0.167200, 0.180481, 0.193740, 0.206975, 0.220186, 0.233370, 0.246526, 0.259653, 0.272748, 0.285811, 0.298840, 0.311834, 0.324791, 0.337709, 0.350588, 0.363425, 0.376221, 0.388972, 0.401678, 0.414338, 0.426950, 0.439513, 0.452026, 0.464488, 0.476896, 0.489251, 0.501551, 0.513795, 0.525982, 0.538110, 0.550179, 0.562188, 0.574135, 0.586020, 0.597842, 0.609599, 0.621292, 0.632918, 0.644477, 0.655969, 0.667392, 0.678746, 0.690030, 0.701243, 0.712384, 0.723454, 0.734451, 0.745374, 0.756224, 0.766998, 0.777698, 0.788323, 0.798871, 0.809343, 0.819737, 0.830055, 0.840294, 0.850456, 0.860539, 0.870543, 0.880468, 0.890314, 0.900080, 0.909766, 0.919373, 0.928899, 0.938345, 0.947711, 0.956996, 0.966200, 0.975324, 0.984367, 0.993329, 1.002210, 1.011011, 1.019730, 1.028370, 1.036928, 1.045406, 1.053804, 1.062121, 1.070359, 1.078516, 1.086593, 1.094591, 1.102510, 1.110349, 1.118109, 1.125791, 1.133394, 1.140919, 1.148367, 1.155736, 1.163029, 1.170245, 1.177384, 1.184446, 1.191433, 1.198345, 1.205181, 1.211943, 1.218631, 1.225244, 1.231784, 1.238252, 1.244646, 1.250969, 1.257219, 1.263399, 1.269508, 1.275546, 1.281515, 1.287414, 1.293245, 1.299007, 1.304701, 1.310328, 1.315889, 1.321383, 1.326811, 1.332174, 1.337472, 1.342706, 1.347877, 1.352984, 1.358028, 1.363011, 1.367932, 1.372792, 1.377592, 1.382332, 1.387012, 1.391634, 1.396197, 1.400703, 1.405151, 1.409543, 1.413879, 1.418159, 1.422385, 1.426555, 1.430673, 1.434736, 1.438747, 1.442706, 1.446613, 1.450468, 1.454273, 1.458028, 1.461734, 1.465390, 1.468998, 1.472558, 1.476070, 1.479536, 1.482955, 1.486328, 1.489656, 1.492939, 1.496177, 1.499372, 1.502523, 1.505632, 1.508698, 1.511722, 1.514705, 1.517647, 1.520548, 1.523410, 1.526232, 1.529015, 1.531759, 1.534466, 1.537135, 1.539767, 1.542362, 1.544921, 1.547444, 1.549932, 1.552384, 1.554803, 1.557187, 1.559538, 1.561856, 1.564140, 1.566393, 1.568614, 1.570803, 1.572960, 1.575088, 1.577185, 1.579252, 1.581289, 1.583297, 1.585277, 1.587228, 1.589151, 1.591046, 1.592914, 1.594756, 1.596570, 1.598359, 1.600121, 1.601858, 1.603570, 1.605257, 1.606919, 1.608558, 1.610172, 1.611763, 1.613331, 1.614876, 1.616398, 1.617898, 1.619376, 1.620833, 1.622268, 1.623682, 1.625075, 1.626448, 1.627800, 1.629133, 1.630446, 1.631739, 1.633014, 1.634270, 1.635507, 1.636726, 1.637926, 1.639109, 1.640275, 1.641423, 1.642554, 1.643668, 1.644766, 1.645847, 1.646913, 1.647962, 1.648996, 1.650014, 1.651017, 1.652005, 1.652979, 1.653937, 1.654882, 1.655812, 1.656729, 1.657631, 1.658520, 1.659396, 1.660259, 1.661109, 1.661946, 1.662770, 1.663582, 1.664381, 1.665169, 1.665945, 1.666709, 1.667462, 1.668203, 1.668933, 1.669652, 1.670360, 1.671058, 1.671745, 1.672421, 1.673088, 1.673744, 1.674390, 1.675027, 1.675653, 1.676271, 1.676879, 1.677478, 1.678067, 1.678648, 1.679220, 1.679783, 1.680338, 1.680884, 1.681422, 1.681952, 1.682473, 1.682987, 1.683493, 1.683991, 1.684482, 1.684965, 1.685441, 1.685910, 1.686371, 1.686825, 1.687273, 1.687713, 1.688147, 1.688574, 1.688995, 1.689410, 1.689817, 1.690219, 1.690615, 1.691004, 1.691388, 1.691766, 1.692138, 1.692504, 1.692864, 1.693220, 1.693569, 1.693914, 1.694253, 1.694586, 1.694915, 1.695239, 1.695558, 1.695871, 1.696181, 1.696485, 1.696784, 1.697079, 1.697370, 1.697656, 1.697938, 1.698215, 1.698488, 1.698757, 1.699022, 1.699282, 1.699539, 1.699792, 1.700040, 1.700285, 1.700527, 1.700764, 1.700998, 1.701228, 1.701455, 1.701678, 1.701898, 1.702114, 1.702328, 1.702537, 1.702744, 1.702947, 1.703148, 1.703345, 1.703539, 1.703730, 1.703918, 1.704104, 1.704286, 1.704466, 1.704643, 1.704817, 1.704988, 1.705157, 1.705323, 1.705487, 1.705648, 1.705806, 1.705963, 1.706116, 1.706268, 1.706417, 1.706564, 1.706708, 1.706850, 1.706991, 1.707128, 1.707264, 1.707398, 1.707530, 1.707659, 1.707787, 1.707912, 1.708036, 1.708158, 1.708278, 1.708396, 1.708512, 1.708626, 1.708739, 1.708850, 1.708959, 1.709066, 1.709172, 1.709277, 1.709379, 1.709480, 1.709580, 1.709677, 1.709774, 1.709869, 1.709962, 1.710054, 1.710145, 1.710234, 1.710322, 1.710408, 1.710493, 1.710577, 1.710659, 1.710741, 1.710821, 1.710899, 1.710977, 1.711053, 1.711128, 1.711202, 1.711275, 1.711347, 1.711417, 1.711487, 1.711555, 1.711622, 1.711689, 1.711754, 1.711818, 1.711882, 1.711944, 1.712005, 1.712066, 1.712125, 1.712184, 1.712241, 1.712298, 1.712354, 1.712409, 1.712463, 1.712516, 1.712569, 1.712620, 1.712671, 1.712721, 1.712770, 1.712819, 1.712867, 1.712914, 1.712960, 1.713006, 1.713050, 1.713095, 1.713138, 1.713181, 1.713223, 1.713265, 1.713306, 1.713346, 1.713385, 1.713424, 1.713463, 1.713501, 1.713538, 1.713574, 1.713610, 1.713646, 1.713681, 1.713715, 1.713749, 1.713783, 1.713815, 1.713848, 1.713880, 1.713911, 1.713942, 1.713972, 1.714002, 1.714031, 1.714060, 1.714089, 1.714117, 1.714145, 1.714172, 1.714199, 1.714225, 1.714251, 1.714277, 1.714302, 1.714327, 1.714351, 1.714375, 1.714399, 1.714422, 1.714445, 1.714468, 1.714490, 1.714512, 1.714533, 1.714554, 1.714575, 1.714596, 1.714616, 1.714636, 1.714656, 1.714675, 1.714694, 1.714713, 1.714731, 1.714749 };


float SIGMOID(float x) {

    if (x < -N) x = -N;
    if (x > N)  x = N;
#pragma HLS PIPELINE II=1

    int index = (int)((x + N) * SCALE_FACTOR);

    return sigmoidLUT[index];
}


#endif
